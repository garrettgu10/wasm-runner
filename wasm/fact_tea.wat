(module (import "js" "secmem" (memory $secmem secret 512)) (import "js" "pubmem" (memory $pubmem 512)) (global $srsp (mut i32) (i32.const 33554432)) (global $prsp (mut i32) (i32.const 33554432))  (func $memcpy_sec_sec untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.load 0 (i32.add (get_local $src) (get_local $curr)))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_pub_pub untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.load 1 (i32.add (get_local $src) (get_local $curr)))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_pub_sec untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.classify (i64.load 1 (i32.add (get_local $src) (get_local $curr))))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_sec_pub trusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.declassify (s64.load 0 (i32.add (get_local $src) (get_local $curr))))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $bzero_sec untrusted (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.const 0)) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $bzero_pub untrusted (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.const 0)) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $decrypt untrusted (param $__v12_v i32) (param $__v13_k i32)  (local $__rctx s32) (local $__v14_delta s32) (local $__v15_sum s32) (local $__v16_v0 s32) (local $__v17_v1 s32) (local $__v18_k0 s32) (local $__v19_k1 s32) (local $__v20_k2 s32) (local $__v21_k3 s32) (local $__v22_i i32) (local $srbp i32) (local $prbp i32) (set_local $srbp (get_global $srsp)) (set_local $prbp (get_global $prsp)) (set_local $__rctx (s32.const 1)) (set_local $__v14_delta (s32.const 2654435769)) (set_local $__v15_sum (s32.const 3337565984)) (set_local $__v16_v0 (s32.load 0 (i32.add (get_local $__v12_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v17_v1 (s32.load 0 (i32.add (get_local $__v12_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))))) (set_local $__v18_k0 (s32.load 0 (i32.add (get_local $__v13_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v19_k1 (s32.load 0 (i32.add (get_local $__v13_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))))) (set_local $__v20_k2 (s32.load 0 (i32.add (get_local $__v13_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 2)))))) (set_local $__v21_k3 (s32.load 0 (i32.add (get_local $__v13_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 3))))))(set_local $__v22_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v22_i) (i32.const 32))) (set_local $__v17_v1 (s32.sub (get_local $__v17_v1) (s32.xor (s32.xor (s32.add (s32.shl (get_local $__v16_v0) (s32.const 4)) (get_local $__v20_k2)) (s32.add (get_local $__v16_v0) (get_local $__v15_sum))) (s32.add (s32.shr_u (get_local $__v16_v0) (s32.const 5)) (get_local $__v21_k3))))) (set_local $__v16_v0 (s32.sub (get_local $__v16_v0) (s32.xor (s32.xor (s32.add (s32.shl (get_local $__v17_v1) (s32.const 4)) (get_local $__v18_k0)) (s32.add (get_local $__v17_v1) (get_local $__v15_sum))) (s32.add (s32.shr_u (get_local $__v17_v1) (s32.const 5)) (get_local $__v19_k1))))) (set_local $__v15_sum (s32.sub (get_local $__v15_sum) (get_local $__v14_delta))) (set_local $__v22_i (i32.add (get_local $__v22_i) (i32.const 1))) (br 0)))(s32.store 0 (i32.add (get_local $__v12_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))) (get_local $__v16_v0)) (s32.store 0 (i32.add (get_local $__v12_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))) (get_local $__v17_v1))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return)(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp)) ) (func $encrypt untrusted (param $__v1_v i32) (param $__v2_k i32)  (local $__rctx s32) (local $__v3_delta s32) (local $__v4_sum s32) (local $__v5_v0 s32) (local $__v6_v1 s32) (local $__v7_k0 s32) (local $__v8_k1 s32) (local $__v9_k2 s32) (local $__v10_k3 s32) (local $__v11_i i32) (local $srbp i32) (local $prbp i32) (set_local $srbp (get_global $srsp)) (set_local $prbp (get_global $prsp)) (set_local $__rctx (s32.const 1)) (set_local $__v3_delta (s32.const 2654435769)) (set_local $__v4_sum (s32.const 0)) (set_local $__v5_v0 (s32.load 0 (i32.add (get_local $__v1_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v6_v1 (s32.load 0 (i32.add (get_local $__v1_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))))) (set_local $__v7_k0 (s32.load 0 (i32.add (get_local $__v2_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v8_k1 (s32.load 0 (i32.add (get_local $__v2_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))))) (set_local $__v9_k2 (s32.load 0 (i32.add (get_local $__v2_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 2)))))) (set_local $__v10_k3 (s32.load 0 (i32.add (get_local $__v2_k) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 3))))))(set_local $__v11_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v11_i) (i32.const 32))) (set_local $__v4_sum (s32.add (get_local $__v4_sum) (get_local $__v3_delta))) (set_local $__v5_v0 (s32.add (get_local $__v5_v0) (s32.xor (s32.xor (s32.add (s32.shl (get_local $__v6_v1) (s32.const 4)) (get_local $__v7_k0)) (s32.add (get_local $__v6_v1) (get_local $__v4_sum))) (s32.add (s32.shr_u (get_local $__v6_v1) (s32.const 5)) (get_local $__v8_k1))))) (set_local $__v6_v1 (s32.add (get_local $__v6_v1) (s32.xor (s32.xor (s32.add (s32.shl (get_local $__v5_v0) (s32.const 4)) (get_local $__v9_k2)) (s32.add (get_local $__v5_v0) (get_local $__v4_sum))) (s32.add (s32.shr_u (get_local $__v5_v0) (s32.const 5)) (get_local $__v10_k3))))) (set_local $__v11_i (i32.add (get_local $__v11_i) (i32.const 1))) (br 0)))(s32.store 0 (i32.add (get_local $__v1_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 0)))) (get_local $__v5_v0)) (s32.store 0 (i32.add (get_local $__v1_v) (i32.mul (i32.const 4) (i32.wrap_i64 (i64.const 1)))) (get_local $__v6_v1))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return)(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp)) )(export "decrypt" (func $decrypt)) (export "encrypt" (func $encrypt)))